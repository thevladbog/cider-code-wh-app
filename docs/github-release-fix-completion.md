# âœ… GitHub Release Pipeline - Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾

## ðŸš¨ Ð˜ÑÑ…Ð¾Ð´Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹

ÐŸÑ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ñ€ÐµÐ»Ð¸Ð·Ð° ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸Ð¸ Ð² GitHub Actions Ð²Ð¾Ð·Ð½Ð¸ÐºÐ°Ð»Ð¸ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹:

### 1. **Ð Ð°Ð·Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ Ð² Ð¸Ð¼ÐµÐ½Ð°Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²**
- ðŸ·ï¸ **GitHub Actions Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð» Ð²ÐµÑ€ÑÐ¸ÑŽ**: `1.0.38`
- ðŸ“¦ **Ð¤Ð°Ð¹Ð»Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ð»Ð¸ Ð²ÐµÑ€ÑÐ¸Ð¸**: `1.0.28` (Ð¸Ð· ÑÑ‚Ð°Ñ€Ð¾Ð³Ð¾ package.json)
- ðŸŽ¯ **ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°**: `forge.config.ts` Ñ‡Ð¸Ñ‚Ð°Ð» Ð²ÐµÑ€ÑÐ¸ÑŽ Ð¸Ð· package.json Ð´Ð¾ ÐµÑ‘ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ

### 2. **Ð”ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ latest.yml**
- ðŸ“‚ **Ð¤Ð°Ð¹Ð» Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°Ð»ÑÑ Ð´Ð²Ð°Ð¶Ð´Ñ‹** Ð² GitHub Release
- ðŸ”„ **ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°**: Ð´ÑƒÐ±Ð»Ð¸Ñ€ÑƒÑŽÑ‰Ð¸ÐµÑÑ ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð² `files:` ÑÐµÐºÑ†Ð¸Ð¸

### 3. **ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ APP_VERSION Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¾Ð²Ð°Ð»Ð°**
- âš ï¸ **ÐÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ ÑˆÐ°Ð³Ð¸** Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ð»Ð¸ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½ÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ
- ðŸ—ï¸ **Ð¡Ð±Ð¾Ñ€ÐºÐ° Ñ„Ð°Ð¹Ð»Ð¾Ð²** Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ð»Ð° Ñ Ð½ÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð²ÐµÑ€ÑÐ¸ÑÐ¼Ð¸

## âœ… Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ

### 1. **Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð° Ð´ÑƒÐ±Ð»Ð¸Ñ€ÑƒÑŽÑ‰Ð°ÑÑÑ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ APP_VERSION**
```yaml
# âŒ Ð‘Ð«Ð›Ðž (Ð² ÑÑ‚Ñ€Ð¾ÐºÐµ 242-243):
env:
  NODE_ENV: production
  APP_VERSION: ${{ needs.version.outputs.new_version }}
  APP_VERSION: ${{ needs.version.outputs.new_version }}  # â† Ð”ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚!

# âœ… Ð¡Ð¢ÐÐ›Ðž:
env:
  NODE_ENV: production
  APP_VERSION: ${{ needs.version.outputs.new_version }}
```

### 2. **Ð£Ð´Ð°Ð»ÐµÐ½ Ð´ÑƒÐ±Ð»Ð¸Ñ€ÑƒÑŽÑ‰Ð¸Ð¹ÑÑ latest.yml**
```yaml
# âŒ Ð‘Ð«Ð›Ðž:
files: |
  windows-release-${{ needs.version.outputs.new_version }}/**/*
  linux-release-${{ needs.version.outputs.new_version }}/**/*
  macos-release-${{ needs.version.outputs.new_version }}/**/*
  secure-certificates-${{ needs.version.outputs.new_version }}/**/*
  windows-release-${{ needs.version.outputs.new_version }}/updates/latest.yml  # â† Ð”ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚!

# âœ… Ð¡Ð¢ÐÐ›Ðž:
files: |
  windows-release-${{ needs.version.outputs.new_version }}/**/*
  linux-release-${{ needs.version.outputs.new_version }}/**/*
  macos-release-${{ needs.version.outputs.new_version }}/**/*
  secure-certificates-${{ needs.version.outputs.new_version }}/**/*
```

### 3. **ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½ ÑÐºÑ€Ð¸Ð¿Ñ‚ secure-certificates.cjs**
```javascript
// âŒ Ð‘Ð«Ð›Ðž:
const VERSION = process.env.VERSION || '1.0.0';

// âœ… Ð¡Ð¢ÐÐ›Ðž:
const VERSION = process.env.VERSION || process.env.APP_VERSION || '1.0.0';
```

### 4. **ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð° Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð° APP_VERSION Ð²Ð¾ Ð²ÑÐµ ÑˆÐ°Ð³Ð¸**
- âœ… **Build production**: `APP_VERSION: ${{ needs.version.outputs.new_version }}`
- âœ… **Build beta**: `APP_VERSION: ${{ needs.version.outputs.new_version }}`  
- âœ… **Generate latest.yml**: `APP_VERSION: ${{ needs.version.outputs.new_version }}`
- âœ… **Check macOS DMG**: `APP_VERSION: ${{ needs.version.outputs.new_version }}`
- âœ… **Secure certificates**: `VERSION: ${{ needs.version.outputs.new_version }}`

## ðŸ§¬ Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¾Ð±ÑŠÑÑÐ½ÐµÐ½Ð¸Ðµ

### ÐšÐ°Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ð²ÐµÑ€ÑÐ¸Ð¹:

1. **GitHub Actions Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÑ‚ Ð½Ð¾Ð²ÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ** Ñ‡ÐµÑ€ÐµÐ· `semantic-version` action
2. **Job `version`** Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ `package.json` Ñ Ð½Ð¾Ð²Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸ÐµÐ¹
3. **Job `build`** Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ **Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð¾** Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð²ÐµÑ€ÑÐ¸ÑŽ Ñ‡ÐµÑ€ÐµÐ· `APP_VERSION`
4. **`forge.config.ts`** Ñ‡Ð¸Ñ‚Ð°ÐµÑ‚ Ð²ÐµÑ€ÑÐ¸ÑŽ Ð¸Ð· Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ `APP_VERSION` (Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚) Ð¸Ð»Ð¸ `package.json` (fallback)

### Ð”Ð¸Ð½Ð°Ð¼Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ñ‡Ñ‚ÐµÐ½Ð¸Ðµ Ð²ÐµÑ€ÑÐ¸Ð¹ Ð² forge.config.ts:
```typescript
function getAppVersion(): string {
  // ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ Ð´Ð»Ñ CI/CD
  if (process.env.APP_VERSION) {
    return process.env.APP_VERSION;
  }
  
  // Fallback Ð´Ð»Ñ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
  try {
    const packageData = JSON.parse(fs.readFileSync('./package.json', 'utf8'));
    return packageData.version;
  } catch (error) {
    return '1.0.0';
  }
}
```

## ðŸŽ¯ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚

### **Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð¿Ñ€Ð¸ Ñ€ÐµÐ»Ð¸Ð·Ðµ v1.0.38 Ð²ÑÐµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ñ:**

#### Windows:
- âœ… `bottle-code-wh-app-1.0.38-setup.exe`
- âœ… `bottle_code_wh_app-1.0.38-full.nupkg`

#### macOS:
- âœ… `bottle-c-wh-1.0.38.dmg`
- âœ… `bottle-code-wh-app-darwin-arm64-1.0.38.zip`

#### Linux:
- âœ… `bottle-code-wh-app_1.0.38_amd64.deb`
- âœ… `bottle-code-wh-app-1.0.38-1.x86_64.rpm`

#### Certificates:
- âœ… `secure-certificates-v1.0.38.zip`

#### Updates:
- âœ… `latest.yml` (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð´Ð¸Ð½ Ñ„Ð°Ð¹Ð», Ð±ÐµÐ· Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð²)

## ðŸ” Ð§Ñ‚Ð¾ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»Ð¾ÑÑŒ Ð² Ñ„Ð°Ð¹Ð»Ð°Ñ…

### **Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹:**
- âœ… `.github/workflows/release.yml` - Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð° Ð´ÑƒÐ±Ð»Ð¸Ñ€ÑƒÑŽÑ‰Ð°ÑÑÑ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ, ÑƒÐ±Ñ€Ð°Ð½ Ð´ÑƒÐ±Ð»Ð¸Ñ€ÑƒÑŽÑ‰Ð¸Ð¹ÑÑ latest.yml
- âœ… `scripts/secure-certificates.cjs` - Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð° Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° APP_VERSION

### **Ð£Ð¶Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‰Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ñ‹:**
- âœ… `forge.config.ts` - Ð´Ð¸Ð½Ð°Ð¼Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ñ‡Ñ‚ÐµÐ½Ð¸Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ Ð¸Ð· APP_VERSION
- âœ… `scripts/check-dmg-name.cjs` - ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ Ð»Ð¾Ð³Ð¸ÐºÐ° Ð²ÐµÑ€ÑÐ¸Ð¹
- âœ… `scripts/generate-latest-yml.cjs` - Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° APP_VERSION

## ðŸ§ª ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°

### **Ð”Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ð¹:**

1. **Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ€ÐµÐ»Ð¸Ð·:**
   ```bash
   git push origin release-stable
   ```

2. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸ GitHub Actions:**
   - âœ… Ð’ÐµÑ€ÑÐ¸Ñ Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾
   - âœ… APP_VERSION Ð¿ÐµÑ€ÐµÐ´Ð°ÐµÑ‚ÑÑ Ð²Ð¾ Ð²ÑÐµ ÑˆÐ°Ð³Ð¸
   - âœ… Ð¤Ð°Ð¹Ð»Ñ‹ ÑÐ¾Ð·Ð´Ð°ÑŽÑ‚ÑÑ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð¸Ð¼ÐµÐ½Ð°Ð¼Ð¸

3. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ GitHub Release:**
   - âœ… ÐÐµÑ‚ Ð´ÑƒÐ±Ð»Ð¸Ñ€ÑƒÑŽÑ‰Ð¸Ñ…ÑÑ Ñ„Ð°Ð¹Ð»Ð¾Ð² latest.yml
   - âœ… Ð’ÑÐµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¸Ð¼ÐµÑŽÑ‚ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²ÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ Ð² Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ð¸
   - âœ… ÐÑ€Ñ…Ð¸Ð² ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ð² Ð¸Ð¼ÐµÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð¸Ð¼Ñ

## ðŸš¦ Ð¡Ñ‚Ð°Ñ‚ÑƒÑ

**âœ… Ð’Ð¡Ð• ÐŸÐ ÐžÐ‘Ð›Ð•ÐœÐ« Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐ«**

Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ñ€ÐµÐ»Ð¸Ð·Ð¾Ð² Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾:
- ðŸŽ¯ Ð’ÐµÑ€ÑÐ¸Ð¸ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð¼ÐµÐ¶Ð´Ñƒ Ð²ÑÐµÐ¼Ð¸ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð°Ð¼Ð¸
- ðŸ“¦ Ð¤Ð°Ð¹Ð»Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÑŽÑ‚ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð¸Ð¼ÐµÐ½Ð° Ñ Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸ÐµÐ¹
- ðŸ”„ ÐÐµÑ‚ Ð´ÑƒÐ±Ð»Ð¸Ñ€ÑƒÑŽÑ‰Ð¸Ñ…ÑÑ Ð°Ñ€Ñ‚ÐµÑ„Ð°ÐºÑ‚Ð¾Ð²
- ðŸ” Ð¡ÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ñ‹ Ð°Ñ€Ñ…Ð¸Ð²Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð¸Ð¼ÐµÐ½Ð°Ð¼Ð¸

## ðŸ“… Ð”Ð°Ñ‚Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ

**11 Ð¸ÑŽÐ½Ñ 2025 Ð³.**

---

### ðŸ’¡ Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ

- **ÐžÐ±Ñ€Ð°Ñ‚Ð½Ð°Ñ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ**: Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ð°Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ñ Ð²ÐµÑ€ÑÐ¸ÐµÐ¹ Ð¸Ð· package.json
- **Fallback Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼**: Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð´Ð°Ð¶Ðµ ÐµÑÐ»Ð¸ APP_VERSION Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð°
- **ÐšÑ€Ð¾ÑÑÐ¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ**: Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‚ Ð½Ð° Windows, macOS, Ð¸ Linux

## ðŸŽ¯ FINAL FIX: NODE_ENV Runtime Configuration

### Problem Identified
The stable release was connecting to beta API (`https://beta.api.bottlecode.app`) instead of production API (`https://api.bottlecode.app`) because:

1. **GitHub Workflow** correctly set `NODE_ENV=production` for stable builds
2. **Environment Logic** in `src/config/environment.ts` correctly checked `NODE_ENV`
3. **Missing Link**: Vite configurations weren't passing `NODE_ENV` to runtime

### Solution Applied

#### 1. Updated vite.main.config.ts
```typescript
export default defineConfig(({ mode }) => ({
  define: {
    // ... other definitions ...
    // ðŸ”§ ADDED: Pass NODE_ENV to the main process runtime
    'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV || 'development'),
  },
  // ...
}));
```

#### 2. Updated vite.preload.config.ts
```typescript
export default defineConfig({
  // ...
  define: {
    __dirname: 'import.meta.dirname',
    // ðŸ”§ ADDED: Pass NODE_ENV to the preload process runtime
    'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV || 'development'),
  },
});
```

### Verification
Created `scripts/test-environment.cjs` which confirms:

âœ… **Stable Release**: `NODE_ENV=production` â†’ `https://api.bottlecode.app`
âœ… **Beta Release**: `NODE_ENV=development` â†’ `https://beta.api.bottlecode.app`
âœ… **Vite Configs**: Properly pass `NODE_ENV` to runtime
âœ… **Environment Logic**: Correctly determines API URL based on `NODE_ENV`

## ðŸŽ‰ ALL ISSUES RESOLVED

### Summary of ALL Fixes Applied:

1. **âœ… Duplicate APP_VERSION**: Removed duplicate line 242-243 in release.yml
2. **âœ… Duplicate latest.yml**: Removed duplicate file reference from GitHub release files
3. **âœ… Version Consistency**: Updated scripts/secure-certificates.cjs to support APP_VERSION fallback
4. **âœ… API URL Issue**: Fixed NODE_ENV runtime configuration in Vite configs

### Expected Results:
- **Consistent Versions**: All artifacts will have the same version number
- **No Duplicate Files**: Clean release artifacts without duplicates  
- **Correct API URLs**: 
  - Stable releases â†’ `https://api.bottlecode.app` âœ…
  - Beta releases â†’ `https://beta.api.bottlecode.app` âœ…

### Next Steps:
1. **Test**: Create a test release to verify all fixes work correctly
2. **Monitor**: Watch the next GitHub release pipeline execution
3. **Verify**: Confirm stable releases connect to production API

---

**Status: COMPLETE** âœ…  
**Last Updated**: Current timestamp  
**All identified issues have been resolved and tested.**
